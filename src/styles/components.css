/* =========================
   THE GREY — components.css
   MTG dimensions • clean edge/shadow
   Hand ribbon fixed + iOS-safe (no clipping)
   ========================= */

/* ---------- Theme tokens ---------- */
:root{
  --bg:#F3EEE5;
  --panel:#FFF;
  --panel-soft:#F9F6F0;
  --ink:#2a2a2a;
  --muted:#777;
  --chip:#f2e7d0;
  --chip-ink:#945c00;

  /* MTG ratio ≈ 3.5 / 2.5 = 1.4 */
  --card-ratio: 1.4;
  --card-w: 220px;                         /* desktop base width */
  --card-h: calc(var(--card-w) * var(--card-ratio));

  --radius: 18px;
  --shadow: 0 6px 20px rgba(0,0,0,.08);
}

/* ---------- Base ---------- */
*{ box-sizing:border-box; }

html, body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font:16px/1.4 system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif;
  /* Ensure fixed children behave correctly on iOS */
  transform:none !important;
  -webkit-transform:none !important;
  overflow:visible !important;
}

/* Leave space so page content never sits under the fixed hand tray */
body{
  padding-bottom: calc(var(--card-h) + 28px + env(safe-area-inset-bottom, 0)) !important;
}

/* ---------- Shell panels ---------- */
.wrap{ max-width:1200px; margin:24px auto 160px; padding:0 16px; }
.zone{
  background:var(--panel); border-radius:14px; box-shadow:var(--shadow);
  padding:18px; margin:12px 0;
}
.zone .title{ font-weight:600; color:#594f43; margin:0 0 8px; }

/* ---------- Aetherflow chips ---------- */
.costCell{ display:flex; justify-content:center; }
.costChip{
  display:inline-flex; align-items:center; justify-content:center;
  width:28px; height:28px; border-radius:999px;
  background:var(--chip); color:var(--chip-ink); font-weight:600;
  box-shadow: inset 0 1px 0 #fff8, 0 1px 2px rgba(0,0,0,.06);
}

/* =========================
   Card — MTG look
   ========================= */

/* Apply MTG size globally (cards and slots) */
.card{ width: var(--card-w); height: var(--card-h); }
.slotCell{ width: var(--card-w); height: var(--card-h); }

/* Base card: parchment face, clean rounded edge, subtle edge line */
.card{
  position:relative;
  border-radius:var(--radius);
  background:linear-gradient(#fff,#faf8f4);
  background-clip:padding-box;
  box-shadow: var(--shadow);
  padding:14px;
  display:flex; flex-direction:column;

  /* Compositor-friendly */
  transform-origin:center center;
  will-change:transform;
  transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;

  user-select:none; -webkit-user-drag:none; touch-action:pan-y;
  -webkit-backface-visibility:hidden; backface-visibility:hidden;
}

/* Inner printed edge line (MTG feel) */
.card::before{
  content:""; position:absolute; inset:0; border-radius:inherit;
  box-shadow: inset 0 0 0 1px #e9e2d7; pointer-events:none;
}

/* Content blocks inside a card */
.card .cHead{ margin-bottom:8px; }
.card .cName{ font-weight:700; letter-spacing:.2px; }
.card .cType{ font-size:12px; color:var(--muted); }
.card .cBody{ flex:1 1 auto; color:#3a3a3a; }
.card .cStats{ display:flex; gap:8px; }
.card .cStats .stat{
  font-size:12px; background:#fff6e6; color:#b35a00;
  border-radius:12px; padding:3px 8px; border:1px solid #f3dfbf;
}

/* Hover lift (only when NOT previewing or dragging) */
.card:hover:not(.is-preview):not(.is-dragging){
  transform: translateY(-14px) scale(1.02);
  box-shadow: 0 10px 26px rgba(0,0,0,.12);
  filter:none;
}

/* =========================
   Hand (Ribbon)
   ========================= */

/* Fixed tray pinned to the bottom center, never clipping */
.ribbon-wrap{
  position:fixed !important;
  left:50%; bottom: calc(env(safe-area-inset-bottom, 0) + 8px);
  transform:translateX(-50%);
  width:100%; max-width:100vw;
  display:flex; justify-content:center; align-items:flex-end;
  overflow:visible !important; pointer-events:none;
  z-index:2147483646 !important; isolation:isolate;
  background:transparent !important;
}

/* Scrollable hand row inside the tray */
.ribbon{
  position:relative;
  height:calc(var(--card-h) + 16px);
  display:flex; align-items:flex-end; justify-content:center;
  gap:0; padding:0 16px 0;
  overflow-x:auto !important; overflow-y:visible !important;
  -webkit-overflow-scrolling:touch;
  pointer-events:auto; z-index:2 !important;
  background:transparent !important;
}

/* Cards peek and overlap slightly (fan) */
.ribbon .card{
  position:relative;
  transform: translateY(10px);
  transition: transform 120ms ease, filter 120ms ease;
  will-change: transform;
  margin-left:-56px;                   /* tighter fan */
  z-index:1;
}
.ribbon .card:first-child{ margin-left:0; }

/* Hover/drag lift from ribbon (visual only; JS owns transforms during drag) */
.ribbon .card:hover:not(.is-preview):not(.is-dragging){
  transform: translateY(-14px)