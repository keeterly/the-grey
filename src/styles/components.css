/* ============================================================
   THE GREY — components.css (v2.3)
   - Responsive, math-driven hand (centered, any count)
   - Auto respects mobile safe areas
   ============================================================ */

/* -------- Base -------- */
* { box-sizing: border-box; -webkit-user-select:none; user-select:none; -webkit-tap-highlight-color: transparent; }
html, body { height: 100%; }
body { margin:0; padding:0; background:#f3efe8; color:#3a3128; overflow-x:hidden; font-family: "Inter", system-ui, sans-serif; }

/* -------- Cards -------- */
.card{
  background: linear-gradient(to bottom, #fefcf8 0%, #f4efe6 100%);
  border-radius: 14px;
  box-shadow: 0 3px 6px rgba(0,0,0,.1);
  width: 180px; height: 250px;
  display:flex; flex-direction:column; justify-content:space-between;
  overflow:hidden;
  transition: transform .25s ease, filter .25s ease;
}
.cHead{ padding:10px 12px 4px; }
.cName{ font-size:14px; font-weight:600; }
.cType{ font-size:11px; opacity:.6; }
.cBody{ flex:1; padding:0 12px; font-size:13px; }
.cStats{ font-size:11px; opacity:.6; text-align:right; padding:4px 10px 8px 0; }

/* -------- Zones (boards/flow) -------- */
#aiBoard, #aetherflow, #yourBoard{
  display:flex; gap:16px; flex-wrap:nowrap; overflow:visible; align-items:flex-start;
}

/* -------- Instant pulse -------- */
@keyframes uiPulse{
  0%{ filter:brightness(1); transform: translateY(-14px) scale(1.04) }
  50%{ filter:brightness(1.15) }
  100%{ filter:brightness(1); transform: translateY(-14px) scale(1.04) }
}

/* ============================================================
   HAND / RIBBON — centered fan for any hand size
   ============================================================ */
.ribbon-wrap{
  position:fixed; left:0; bottom:0; width:100%;
  height:300px;
  padding-left: max(12px, env(safe-area-inset-left));
  padding-right: max(12px, env(safe-area-inset-right));
  padding-bottom: max(8px, env(safe-area-inset-bottom));
  display:flex; justify-content:center; align-items:flex-end;
  pointer-events:none; z-index:100;
  /* background: rgba(255,0,0,.0);  debug */
}

.ribbon{
  /* Hand parameters via CSS variables (overridable) */
  --n: 1;                 /* number of cards (set by JS)        */
  --spread: 120px;        /* horizontal spacing per step (JS)    */
  --rot: 10deg;           /* rotation per step (JS)              */
  --card-w: 180px;
  --card-h: 250px;

  position:relative;
  width: 100%;
  height:100%;
  pointer-events:auto;
  perspective: 1200px; transform-style: preserve-3d;
}

.ribbon .card{
  position:absolute; left:50%; bottom:40px;
  width: var(--card-w); height: var(--card-h);
  margin-left: calc(var(--card-w)/-2);
  transform-origin: bottom center;
  cursor: grab;

  /* place by index: translateX = (i - center) * spread; rotate similarly */
  transform:
    translateX(calc( (var(--i) - (var(--n) - 1)/2 ) * var(--spread) ))
    translateY(calc( (abs(var(--i) - (var(--n) - 1)/2) * -2px) )) /* tiny arc */
    rotate( calc( (var(--i) - (var(--n) - 1)/2 ) * var(--rot) ));
  z-index: calc(100 + (var(--i)));
  animation: drawIn .25s ease-out;
}

/* Hover raise (desktop) */
@media (hover:hover){
  .ribbon .card:hover{
    transform:
      translateX(calc( (var(--i) - (var(--n) - 1)/2 ) * var(--spread) ))
      translateY(-80px) rotate(0deg) scale(1.12);
    z-index:999;
    filter: brightness(1.08);
  }
}

/* Instant pulse in hand */
.ribbon .card.is-instant{ animation: uiPulse 1.8s ease-in-out infinite; }
.ribbon .card.is-phantom{ opacity:0; pointer-events:none; }

@keyframes drawIn{
  from{ transform: translateY(60px) scale(.9); opacity:0; }
  to  { transform: translateY(0) scale(1); opacity:1; }
}

/* -------- Mobile tuning -------- */
@media (max-width: 768px){
  .ribbon-wrap{ height: 260px; }
  .ribbon{ --card-w: 160px; --card-h: 220px; }
  .ribbon .card:active{
    transform:
      translateX(calc( (var(--i) - (var(--n) - 1)/2 ) * var(--spread) ))
      translateY(-70px) rotate(0deg) scale(1.18);
    z-index:999;
  }
}

/* Super narrow */
@media (max-width: 420px){
  .ribbon{ --card-w: 148px; --card-h: 205px; }
}