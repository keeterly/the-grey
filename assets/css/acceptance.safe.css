/* The Grey — acceptance.safe.css (r5)
   Goals:
   - Center slot rows (with OR without a .slots wrapper)
   - Aetherflow cards = same size as board cards
   - Hand always accessible (high z-index, larger bottom reserve)
   - Press & hold preview works and doesn’t block drag
   - 1280×720 canvas centered/scaled for desktop + mobile landscape
*/

/* ---------- base / canvas ---------- */

html, body { margin:0; padding:0; background:#f7f5f0; }
html, body {
  -webkit-text-size-adjust:100%;
  -webkit-user-select:none; user-select:none;
  -webkit-touch-callout:none;
  touch-action:manipulation;
  height:100%; width:100%;
  overflow:hidden;
}

:root{
  /* Written by boot-debug.js; defaults are harmless for SSR preview */
  --tg-base-w: 1280;
  --tg-base-h: 720;
  --tg-scale: 1;

  /* viewport-aware rhythm */
  --row-gap: clamp(32px, 5.5vh, 56px);

  /* hand clearance: enough for fan/tilt, bounded so YOU row stays visible */
  --hand-reserve: clamp(120px, 16vh, 200px);

  /* small inner margins inside 1280×720 to avoid edge kiss on odd ARs */
  --edge-pad: clamp(6px, 1.2vh, 12px);

  /* sizing parity (desktop) */
  --card-w: 140px; --card-h: 200px;
  --slot-w: 150px; --slot-h: 210px;
}

@media (max-width: 900px){
  :root{
    --row-gap: clamp(44px, 9vh, 72px);
    --hand-reserve: clamp(120px, 18vh, 200px);
    --card-w: 126px; --card-h: 186px;
    --slot-w: 132px; --slot-h: 190px;
  }
}

#app{
  position:fixed; left:50%; top:50%;
  width:calc(var(--tg-base-w)*1px);
  height:calc(var(--tg-base-h)*1px);
  transform: translate(-50%, -50%) scale(var(--tg-scale));
  transform-origin: 50% 50%;
  will-change: transform;
  contain: layout paint;
  overflow: visible;                 /* do not clip hand or anims */
  padding-top: var(--edge-pad);
  padding-bottom: var(--edge-pad);
  pointer-events:auto;
}

/* ---------- rows / centering ---------- */

.board{ position:relative; width:100%; height:auto; margin-block: var(--row-gap); }

.board .row{ display:flex; flex-direction:column; gap:8px; }

/* Header row uses its original inline layout */
.board .row.head{
  flex-direction:row;
  justify-content:space-between;
  gap:6px;
}

/* ✅ Center ANY non-header row even when no `.slots` wrapper is present */
.board .row:not(.head){
  flex-direction:row;
  justify-content:center;
  align-items:center;
  flex-wrap:wrap;
  gap: clamp(10px, 1.6vmin, 18px);
}

/* …but if there IS a `.slots` wrapper, center that as well (covers both DOM shapes) */
.board .row > .slots{
  display:flex;
  justify-content:center;
  align-items:center;
  flex-wrap:wrap;
  gap: clamp(10px, 1.6vmin, 18px);
}

/* Keep YOU board inside the frame while reserving space for the hand */
.board[data-board="YOU"]{
  margin-top: var(--row-gap);
  padding-bottom: calc(8px + var(--hand-reserve));
}

/* Hide labels you asked to remove temporarily */
.af-title,
.board .name,
.board .hearts,
.board .traits,
.board .badges { display:none !important; }

/* ---------- slots & AF cards ---------- */

.slot, .glyph-slot{
  box-sizing:border-box;
  width: var(--slot-w); height: var(--slot-h);
  border-radius:16px; border:2px dashed rgba(0,0,0,.14);
  background:rgba(255,255,255,.55);
  display:flex; align-items:center; justify-content:center;
  color:#8b7f70;
  font: 14px/1.1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}

.aetherflow{ margin-block: var(--row-gap); }

.af-cards{
  display:flex; justify-content:center; flex-wrap:wrap;
  gap: clamp(10px, 1.6vmin, 18px);
}

/* AF cards exactly match board card footprint */
.af-card{
  width: var(--card-w); height: var(--card-h);
  box-sizing:border-box; border-radius:16px; background:#fff;
  box-shadow:0 1px 6px rgba(0,0,0,.06);
  padding:10px 10px 14px;
  transition: transform .12s ease, box-shadow .12s ease;
  will-change: transform;
}

/* ---------- hand layer & interactions ---------- */

.board[data-board="YOU"] .hand{
  position:relative;
  z-index: 20000;                          /* win hit-tests */
  display:flex; justify-content:center; gap:0;
  pointer-events:auto; padding-top:6px;
}

.hand .card{
  touch-action:none; cursor:grab;
  transition: transform 200ms cubic-bezier(.2,.8,.2,1), box-shadow 200ms ease;
  will-change: transform;
}

.card.is-dragging{
  position:fixed !important;
  z-index: 25000 !important;
  pointer-events:none !important;
}

/* Press & hold preview (boot adds .magnify + .magnify-hand on hold) */
.card.magnify{
  transform: scale(2) !important;
  z-index: 26000 !important;
  box-shadow: 0 18px 48px rgba(0,0,0,.32) !important;
  pointer-events: none !important;
}
.hand .card.magnify-hand{ transform: translateY(-72px) scale(2) !important; }

/* ---------- HUD (kept compact, centered to scaled width) ---------- */

.hud-min{
  position:fixed; left:50%; transform:translateX(-50%);
  bottom: calc(12px + env(safe-area-inset-bottom));
  width: calc(var(--tg-base-w)*1px*var(--tg-scale));
  max-width: 100vw;
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; padding:0 10px; pointer-events:none; z-index: 15000;
}
.hud-min .left, .hud-min .right{ display:flex; align-items:center; gap:10px; pointer-events:auto; }

/* Optional legacy bolt off */
#aetherWell, .hud-min .bolt, [data-hud="energy"]{ display:none!important; }

/* Deck button look (if you style by id or data-role, both covered) */
#deckIcon, [data-role="deck-btn"]{
  display:inline-flex; align-items:center; justify-content:center;
  height:36px; min-width:48px; padding:0 12px;
  border-radius:10px; background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.12);
  font:700 12px/1 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  letter-spacing:.3px;
}

/* ---------- version tag injected by boot ---------- */

#tgHudRoot{ position:fixed; inset:0; z-index:99998; pointer-events:none; }
#tgVersionTag{
  position:absolute; right:12px; top:8px; z-index:99999;
  font:11px/1 monospace; opacity:.55; background:rgba(255,255,255,.85);
  padding:3px 6px; border-radius:6px; box-shadow:0 1px 6px rgba(0,0,0,.06);
}

/* ---------- overlay safety (no accidental blocking) ---------- */

#overlay, .overlay{
  position:fixed; inset:0; display:none; pointer-events:none; z-index:1000;
  background: rgba(0,0,0,0);
}
#overlay.is-open, .overlay.is-open{
  display:block; pointer-events:auto; background: rgba(0,0,0,.35);
}
