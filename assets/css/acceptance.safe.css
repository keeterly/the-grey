/* The Grey — acceptance.safe.css (mobile-unified v2.3.5/v2.3.9)
   Purpose:
   - Center slot rows on all viewports
   - Normalize Aetherflow card size to match board cards
   - Hand sits on its own layer (above boards) and drags freely
   - Press/hold preview polish
   - Keep the 1280×720 canvas scaled/centered via --tg-scale
*/

:root{
  /* scale variables are written by boot-debug.js */
  --tg-scale: 1;
  --tg-scaled-w: 1280px;
  --tg-scaled-h: 720px;

  /* layout rhythm */
  --row-gap: clamp(16px, 2.2vmin, 28px);
  --slot-gap: clamp(10px, 1.6vmin, 18px);

  /* card sizes (desktop) — these mirror src/styles/cards.css */
  --card-w: 140px;
  --card-h: 200px;
  --slot-w: 150px;
  --slot-h: 210px;
}

@media (max-width: 900px){
  :root{
    --card-w: 126px;
    --card-h: 186px;
    --slot-w: 132px;
    --slot-h: 190px;
  }
}

/* ---- App canvas fit + centering --------------------------------------- */

html,body{
  height:100%;
  margin:0;
  background:#f7f5f0;
  color:#2e2923;
  overscroll-behavior: none;
}

#app{
  position:fixed;           /* center to viewport (not any wrapper) */
  left:50%;
  top:50%;
  width:1280px;
  height:720px;
  transform: translate(-50%,-50%) scale(var(--tg-scale));
  transform-origin: 50% 50%;
  will-change: transform;
  z-index: 1;
}

/* If a wrapper exists, make sure it never clips */
.container{ position:static; overflow:visible; }

/* ---- Boards / rows / slots -------------------------------------------- */

.board{
  position:relative;
  width:100%;
  height:auto;
  margin-block: var(--row-gap);
}

.board .row{
  display:flex;
  flex-direction: column;
  gap: 8px;
}

/* Center the slot row */
.board .row > .slots{
  display:flex;
  justify-content:center;          /* << main fix */
  align-items:center;
  flex-wrap:wrap;
  gap: var(--slot-gap);
}

/* Placeholder slots */
.slot,
.glyph-slot{
  box-sizing:border-box;
  width: var(--slot-w);
  height: var(--slot-h);
  border-radius:16px;
  border:2px dashed rgba(0,0,0,.14);
  background:rgba(255,255,255,.55);
  display:flex;
  align-items:center;
  justify-content:center;
  color:#8b7f70;
  font: 14px/1.1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

/* Slot ghost label (keeps size when empty) */
.slot-ghost{
  pointer-events:none;
}

/* Keep “Aetherflow” label out of view per request */
.af-title{ display:none !important; }

/* Aetherflow row — cards centered & sized same as board cards */
.aetherflow{ margin-block: var(--row-gap); }
.af-cards{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap: var(--slot-gap);
}
.af-card{
  position:relative;
  box-sizing:border-box;
  width: var(--card-w);        /* match .card */
  height: var(--card-h);
  border-radius:16px;
  background:#fff;
  box-shadow:0 1px 6px rgba(0,0,0,.06);
  padding:10px 10px 14px;
  transition: transform .12s ease, box-shadow .12s ease;
  will-change: transform;
}
.af-card.afford{ box-shadow:0 2px 10px rgba(0,0,0,.10); }
.af-card.dragging{ z-index: 40; cursor:grabbing; }
.af-card .title{ margin-top:22px; font-weight:600; }
.af-card .cost-chip{
  position:absolute; right:10px; bottom:10px;
  background:#f9e7b6; border-radius:12px; padding:4px 8px; font-weight:600;
}
.af-card.shake{ animation: shake .25s linear 1; }
@keyframes shake{
  0%{ transform: translateX(0); }
  25%{ transform: translateX(-4px); }
  50%{ transform: translateX(4px); }
  75%{ transform: translateX(-2px); }
  100%{ transform: translateX(0); }
}

/* ---- Hand layer -------------------------------------------------------- */

.board[data-board="YOU"] .hand{
  position:relative;
  z-index: 30;                /* above slots + AF */
  display:flex;
  justify-content:center;
  gap: 0;                     /* fan handled by transforms */
  pointer-events:auto;
  padding-top: 6px;
}

/* Drag should not be constrained by touch scrolling */
.board[data-board="YOU"] .hand .card{
  touch-action: none;
  cursor: grab;
}

/* When card is being dragged, float above everything */
.card.is-dragging{
  position:fixed !important;
  z-index: 50 !important;
  pointer-events:none !important;
}

/* ---- Press & hold preview --------------------------------------------- */

.card.magnify{
  transition: transform .12s ease, box-shadow .12s ease;
  box-shadow: 0 8px 26px rgba(0,0,0,.20);
}
.card.magnify-hand{
  transform: scale(1.12) translateZ(0);  /* slight scale on hand only */
}

/* ---- HUD (compact, floating) ------------------------------------------ */

.hud-min{
  position:fixed;
  inset:auto 16px 18px 16px;
  display:flex; align-items:center; justify-content:space-between;
  gap:14px; pointer-events:none; z-index: 60;
}
.hud-min .left, .hud-min .right{ display:flex; align-items:center; gap:12px; pointer-events:auto; }

/* icon buttons */
.icon{
  width:44px; height:44px; border-radius:14px;
  background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.10);
  display:grid; place-items:center;
  font-size:18px; color:#6b5f50; user-select:none;
}
.icon.btn{ cursor:pointer; }
.icon.btn:active{ transform: translateY(1px); }

/* tiny counter bubble */
.icon[data-count]::after{
  content: attr(data-count);
  position:absolute; translate: 16px -16px;
  background:#fff; border-radius:999px; padding:2px 6px; font-size:12px;
  box-shadow:0 1px 6px rgba(0,0,0,.10); color:#6b5f50; font-weight:600;
}

/* Make sure deck lives on the RIGHT next to End Turn; discard on LEFT */
.hud-min .left   > #discardIcon{ order:1; }
.hud-min .right  > #btnEnd{ order:1; }
.hud-min .right  > #deckIcon{ order:2; }

/* Hide the lightning/aether well per request */
#aetherWell{ display:none !important; }

/* Version tag space (the element is injected from boot-debug.js) */
#tgVersionTag{ pointer-events:none; }

/* ---- Mobile landscape niceties ---------------------------------------- */

.mobile-land #app{ transform: translate(-50%,-50%) scale(var(--tg-scale)); }
.mobile-land .hud-min{ inset:auto 12px 14px 12px; }
