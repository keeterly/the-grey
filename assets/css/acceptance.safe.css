/* ============= THE GREY â€” CORE LAYOUT (desktop + mobile landscape) ============= */

/* ---- CSS variables ---- */
:root {
  /* Stage dimensions */
  --tg-base-w: 1280;
  --tg-base-h: 720;

  /* Card + spacing */
  --card-w: 180px;
  --card-h: 260px;
  --slot-w: 180px;
  --slot-h: 260px;

  --row-gap: 36px;
  --slot-gap: 32px;
  --hand-gap: 18px;

  /* Z-layers */
  --z-slots: 1;
  --z-board-cards: 2;
  --z-hand: 3;
  --z-hud: 4;

  --bg-cream: #f7f5f0;
  --ink: #443d35;
  --ink-weak: #7e7265;

  --slot-border: #e6ded2;
  --slot-dash: #d9cdbf;

  --card-bg: #fffdfa;
  --card-shadow: 0 4px 20px rgba(0, 0, 0, .08);

  --chip-bg: #ede6db;
  --chip-active: #f6efe6;
}

/* ---- Global Reset-ish ---- */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  -webkit-text-size-adjust: 100%;
  user-select: none;
  touch-action: manipulation;
  overflow: hidden;
  background: linear-gradient(#f7f5f0, #eee6d9);
  color: var(--ink);
  font: 14px/1.5 "Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

/* ---- Stage scaling container ---- */
#app {
  position: fixed;
  left: 50%;
  top: 50%;
  width: calc(var(--tg-base-w) * 1px);
  height: calc(var(--tg-base-h) * 1px);
  transform: translate(-50%, -50%);
  /* scale is set by mobile.css, but desktop fits naturally; no overflow */
}

.container {
  position: relative;
  width: 100%;
  height: 100%;
  padding: 20px 28px 24px;
  box-sizing: border-box;
}

/* ---- Boards: AI top / YOU bottom ---- */
.board {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* compact header row (weaver + chips + hearts) */
.row-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 880px;
  max-width: 92%;
  margin: 4px 0 6px;
  gap: 8px;
}

.row-head .weaver {
  font-weight: 600;
  color: var(--ink-weak);
}

/* trance chips */
.trances {
  display: flex;
  gap: 6px;
}
.trance-chip {
  background: var(--chip-bg);
  border-radius: 10px;
  padding: 3px 8px;
  font-size: 12px;
  color: var(--ink-weak);
}
.trance-chip.active { background: var(--chip-active); }

/* hearts */
.hearts { display: flex; gap: 4px; }
.heart {
  width: 14px; height: 12px; border-radius: 50% 50% 0 0;
  background: #e1d3c6; position: relative; transform: rotate(-45deg);
}
.heart::after, .heart::before {
  content: ""; position: absolute; width: 14px; height: 12px; border-radius: 50%;
  background: inherit;
}
.heart::before { top: -7px; left: 0; }
.heart::after { top: 0; left: 7px; }
.heart.on { background: #e86d6b; }

/* ---- Slots row ---- */
.slots {
  display: grid;
  grid-template-columns: repeat(4, var(--slot-w));
  grid-auto-rows: var(--slot-h);
  gap: var(--slot-gap);
  place-items: center;
  margin: 8px 0 var(--row-gap);
}

.slot {
  width: var(--slot-w);
  height: var(--slot-h);
  border-radius: 16px;
  border: 2px dashed var(--slot-dash);
  color: #c9bba9;
  display: grid;
  place-items: center;
  background: #fffdfb;
  box-shadow: inset 0 0 0 1px var(--slot-border);
  z-index: var(--z-slots);
}

/* ---- Cards (shared: in slots, in aetherflow, etc.) ---- */
.card {
  width: var(--card-w);
  height: var(--card-h);
  background: var(--card-bg);
  border-radius: 15px;
  box-shadow: var(--card-shadow);
  position: relative;
  overflow: hidden;
  z-index: var(--z-board-cards);
  transform-origin: 50% 100%;
  transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
}

.card .badge {
  position: absolute;
  left: 10px;
  top: 10px;
  font-weight: 600;
  font-size: 12px;
  padding: 3px 8px;
  border-radius: 999px;
  background: #eef0f5;
}
.badge.spell { background: #e9f6ef; color: #2a7f57; }
.badge.instant { background: #ecebff; color: #5a55b3; }
.badge.glyph { background: #ffeae0; color: #8d4d2e; }

.card .title {
  position: absolute;
  left: 16px; right: 16px; top: 44px;
  font-weight: 700; font-size: 16px;
}

.card .cost {
  position: absolute;
  right: 12px; bottom: 10px;
  font-weight: 700;
  color: #d1a54a;
}

/* Press-and-hold preview behaviour */
.card.preview {
  transform: scale(1.18) translateY(-10px);
  box-shadow: 0 10px 40px rgba(0,0,0,.22);
  z-index: calc(var(--z-hand) + 1);
}

/* ---- Hand (overlay) ---- */
.hand {
  position: absolute;
  bottom: 78px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: var(--hand-gap);
  align-items: flex-end;
  z-index: var(--z-hand);
  pointer-events: auto;
}

[data-board="YOU"] .hand .card {
  position: relative;
  transform: translate(-50%, 0) rotate(0deg);
  left: 50%;
}

/* drag helpers (wireHandDrag uses classes like .dragging) */
.card.dragging {
  filter: drop-shadow(0 12px 28px rgba(0,0,0,.3));
  transform: scale(1.06) !important;
  z-index: calc(var(--z-hand) + 2);
}

/* ---- HUD (End Turn / Deck / Undo) ---- */
.hud {
  position: absolute;
  right: 28px;
  bottom: 22px;
  display: flex;
  gap: 10px;
  z-index: var(--z-hud);
}

.hud-btn {
  min-width: 52px;
  height: 44px;
  padding: 0 14px;
  border: 1px solid #e3d9cc;
  border-radius: 12px;
  background: #fffaf3;
  color: var(--ink);
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,.06);
}
.hud-btn:active { transform: translateY(1px); }

/* ---- Aether display ---- */
#aetherDisplay {
  position: absolute;
  right: 170px;        /* leaves room for HUD buttons on the far right */
  bottom: 30px;
  display: flex;
  gap: 6px;
  height: 20px;
  align-items: center;
  z-index: var(--z-hud);
}
.aether {
  width: 16px; height: 16px; border-radius: 4px; background: #e9e1d6; box-shadow: inset 0 0 0 1px #d7c9b8;
}
.aether.blue { background: #9cd2ff; box-shadow: inset 0 0 0 1px #67b6ff; }
.aether.red  { background: #ff9aa3; box-shadow: inset 0 0 0 1px #ff6b79; }

/* ---- Version tag (top-right) ---- */
body::after {
  content: attr(data-build);
  position: fixed;
  right: 14px; top: 10px;
  padding: 4px 10px;
  font-size: 12px; color: #7f7568;
  background: #f1eadf;
  border-radius: 999px;
  box-shadow: 0 1px 4px rgba(0,0,0,.05);
}

/* (Optional) hide big "Aetherflow" text if it exists in content */
.aetherflow-label { display: none !important; }
