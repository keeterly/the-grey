/* acceptance.safe.css â€” r4a
   - Desktop + Mobile Landscape
   - Hand access hot-fix: more bottom reserve, higher z-index, overlay safe defaults
*/

html, body { margin:0; padding:0; background:#f7f5f0; }
html, body {
  -webkit-text-size-adjust:100%;
  -webkit-user-select:none; user-select:none;
  -webkit-touch-callout:none;
  touch-action:manipulation;
  height:100%; width:100%;
  overflow:hidden;
}

/* Base canvas dimensions; JS writes --tg-scale */
:root{
  --tg-base-w: 1280;
  --tg-base-h: 720;
  --tg-scale: 1;

  /* Desktop baseline (bigger hand reserve so the fan never hugs the edge) */
  --row-gap: clamp(32px, 5.5vh, 56px);
  --hand-reserve: clamp(160px, 20vh, 240px);  /* bumped up */

  --edge-pad: clamp(6px, 1.2vh, 12px);

  /* card + slot sizes */
  --card-w: 140px; --card-h: 200px;
  --slot-w: 150px; --slot-h: 210px;
}

@media (max-width: 900px){
  :root{
    --row-gap: clamp(44px, 9vh, 72px);
    --hand-reserve: clamp(130px, 18vh, 220px); /* mobile-landscape reserve */
    --card-w: 126px; --card-h: 186px;
    --slot-w: 132px; --slot-h: 190px;
  }
}

/* Center + scale the board */
#app{
  position:fixed; left:50%; top:50%;
  width:calc(var(--tg-base-w)*1px);
  height:calc(var(--tg-base-h)*1px);
  transform: translate(-50%, -50%) scale(var(--tg-scale));
  transform-origin: 50% 50%;
  will-change: transform;
  contain: layout paint;
  overflow: visible;
  padding-top: var(--edge-pad);
  padding-bottom: var(--edge-pad);
  pointer-events:auto; /* ensure the canvas participates in hit-testing */
}

/* Remove board chrome, keep slots */
#app .board, #app .aetherflow{
  background:transparent!important;
  box-shadow:none!important;
  border:none!important; height:auto;
}

/* Spacing between rows */
#app .board[data-board="AI"]  { margin-bottom: var(--row-gap); }
#app .aetherflow             { margin: var(--row-gap) auto; }
#app .board[data-board="YOU"]{
  position:relative;
  margin-top: var(--row-gap);
  padding-bottom: calc(10px + var(--hand-reserve)); /* more room for the fan */
}

/* Row + centering */
.board .row{ display:flex; flex-direction:column; gap:8px; }
.board .row > .slots{
  display:flex; justify-content:center; align-items:center;
  flex-wrap:wrap; gap: clamp(10px, 1.6vmin, 18px);
}

/* Slots */
.slot, .glyph-slot{
  box-sizing:border-box;
  width: var(--slot-w); height: var(--slot-h);
  border-radius:16px; border:2px dashed rgba(0,0,0,.14);
  background:rgba(255,255,255,.55);
  display:flex; align-items:center; justify-content:center;
  color:#8b7f70; font: 14px/1.1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}

/* Hide Aetherflow title */
.af-title{ display:none !important; }

/* Aetherflow cards same size as board cards */
.af-cards{
  display:flex; justify-content:center; flex-wrap:wrap;
  gap: clamp(10px, 1.6vmin, 18px);
}
.af-card{
  width: var(--card-w); height: var(--card-h);
  box-sizing:border-box; border-radius:16px; background:#fff;
  box-shadow:0 1px 6px rgba(0,0,0,.06);
  padding:10px 10px 14px;
  transition: transform .12s ease, box-shadow .12s ease;
  will-change: transform;
}

/* Hand: keep well above everything and fully interactive */
#app .board[data-board="YOU"] .hand{
  position:relative;
  z-index: 20000;              /* very high to beat any overlay/HUD */
  display:flex; justify-content:center; gap:0;
  pointer-events:auto; padding-top:6px;
}
#app .hand .card{
  touch-action:none; cursor:grab;
  transition: transform 200ms cubic-bezier(.2,.8,.2,1), box-shadow 200ms ease;
  will-change: transform;
}
.card.is-dragging{
  position:fixed !important;
  z-index: 25000 !important;
  pointer-events:none !important;
}

/* Press & hold preview */
.card.magnify{
  transform: scale(2) !important;
  z-index: 26000 !important;
  box-shadow: 0 18px 48px rgba(0,0,0,.32) !important;
  pointer-events: none !important;
}
#app .hand .card.magnify-hand{ transform: translateY(-72px) scale(2) !important; }

/* HUD centered to scaled width (doesn't block the board) */
.hud-min{
  position:fixed; left:50%; transform:translateX(-50%);
  bottom: calc(12px + env(safe-area-inset-bottom));
  width: calc(var(--tg-base-w)*1px*var(--tg-scale));
  max-width: 100vw;
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; padding:0 10px; pointer-events:none; z-index: 15000;
}
.hud-min .left, .hud-min .right{ display:flex; align-items:center; gap:10px; pointer-events:auto; }

/* Hide legacy bolt HUD */
#aetherWell, .hud-min .bolt, [data-hud="energy"]{ display:none!important; }

/* Deck button look */
#deckIcon, [data-role="deck-btn"]{
  display:inline-flex; align-items:center; justify-content:center;
  height:36px; min-width:48px; padding:0 12px;
  border-radius:10px; background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.12);
  font:700 12px/1 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  letter-spacing:.3px;
}

/* Version badge (inserted by boot) */
#tgHudRoot{ position:fixed; inset:0; z-index:99998; pointer-events:none; }
#tgVersionTag{
  position:absolute; right:12px; top:8px; z-index:99999;
  font:11px/1 monospace; opacity:.55; background:rgba(255,255,255,.85);
  padding:3px 6px; border-radius:6px; box-shadow:0 1px 6px rgba(0,0,0,.06);
}

/* --- Overlay safety: never block the board unless explicitly opened --- */
#overlay, .overlay{
  position:fixed; inset:0; display:none; pointer-events:none; z-index:1000;
  background: rgba(0,0,0,0); /* transparent by default */
}
#overlay.is-open, .overlay.is-open{
  display:block; pointer-events:auto; background: rgba(0,0,0,.35);
}
