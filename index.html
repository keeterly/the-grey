<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
<title>The Grey ‚Äî v13 (iOS beta fix, fits screen)</title>
<meta name="theme-color" content="#0b0d10" />
<style>
:root{
  --bg:#0b0d10; --surface:#0f141b; --ink:#eef0f3; --sub:#aeb8c6; --line:#1b2430; --accent:#d7b77a;
  --slot:#0c1219; --chip:#121821; --chipLine:#233246; --btn:#111827; --btnLine:#28364a;
  --card:#121a26; --cardLine:#23344a; --good:#7fe19c; --bad:#ff7a7a;
  --t-spell:#e6c57a; --t-instant:#6fb2ff; --t-glyph:#b58cff; --t-utility:#7bd3c3;
  --p-white:#cfd8e3; --p-gray:#7a889c; --p-black:#1a1f27;
  --fs: clamp(12px, 1.58vw, 15px);
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:#0b0d10;color:var(--ink);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial;
  -webkit-tap-highlight-color:transparent;font-size:var(--fs);overflow:hidden}
@media(orientation:portrait){
  body::before{content:"Rotate to landscape to play";position:fixed;inset:0;
    display:grid;place-items:center;background:#0b0d10;color:#eef0f3;z-index:9999;
    font-weight:800;letter-spacing:.06em}
}
#error{position:fixed;left:0;right:0;bottom:0;z-index:99999;
  background:#7f1d1d;color:#fff;padding:8px 12px;font-size:12px;display:none}
#app{height:100dvh;display:grid;grid-template-rows:58px 1fr 204px}

/* HUD */
.hud{display:flex;align-items:center;gap:8px;padding:8px 12px;
  background:var(--surface);border-bottom:1px solid var(--line)}
.title{font-weight:900;letter-spacing:.12em}
.chips{display:flex;gap:6px;flex-wrap:wrap}
.chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;
  border-radius:999px;background:var(--chip);border:1px solid var(--chipLine);font-size:12px}
.k{color:var(--sub)}
button,select{background:var(--btn);border:1px solid var(--btnLine);color:var(--ink);
  border-radius:10px;padding:8px 12px;font-size:14px;min-height:40px}
button:disabled{opacity:.55}

/* Main */
.main{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:8px 10px}
.panel{background:var(--surface);border:1px solid var(--line);border-radius:12px;
  padding:10px;box-shadow:inset 0 6px 18px rgba(0,0,0,.22)}
.sectionTitle{font-weight:800;margin-bottom:6px}

/* Boards */
.boards{display:grid;grid-template-columns:1fr 1fr;gap:10px;height:100%}
.slots{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.slot{background:var(--slot);border:2px dashed #33465d;border-radius:12px;
  min-height:120px;padding:6px;transition:border-color .1s,box-shadow .1s}
.slot.hot{border-color:#86b7ff;box-shadow:0 0 0 3px rgba(134,183,255,.18) inset}
.slot .cap{display:flex;justify-content:space-between;font-size:11px;color:var(--sub);margin-bottom:4px}
.glyphs{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px;min-height:20px}
.glyph{height:18px;padding:0 8px;display:inline-flex;align-items:center;gap:4px;
  border-radius:999px;background:#2d2450;border:1px solid var(--t-glyph);font-size:11px}

/* Aetherflow & Log */
.marketGrid{display:grid;grid-template-rows:auto auto 1fr auto auto;gap:6px;height:100%}
.costs{display:grid;grid-template-columns:repeat(auto-fit,minmax(36px,1fr));gap:6px}
.cost{display:flex;align-items:center;justify-content:center;height:28px;border-radius:8px;
  background:#0b111a;border:1px solid #213145;color:var(--accent);font-weight:800}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:6px;align-content:start}
.log{background:#0b111a;border:1px solid #1c2a3a;border-radius:8px;padding:6px;height:110px;
  overflow:auto;font-size:12px}

/* Cards */
.card{background:var(--card);border:2px solid var(--cardLine);border-radius:12px;
  padding:6px;box-shadow:0 4px 12px rgba(0,0,0,.25);display:flex;flex-direction:column;min-width:0}
.card[data-t="Spell"]{border-color:var(--t-spell)}
.card[data-t="Instant"]{border-color:var(--t-instant)}
.card[data-t="Glyph"]{border-color:var(--t-glyph)}
.card[data-t="Utility"]{border-color:var(--t-utility)}
.badges{display:flex;gap:4px;flex-wrap:wrap}
.badge{font-size:10px;padding:2px 6px;border-radius:6px;border:1px solid #2b3a51;background:#0b111a}
.name{font-weight:900;margin:4px 0;color:var(--accent);font-size:13px}
.text{font-size:11px;color:var(--sub);line-height:1.25}
.actions{margin-top:auto;display:flex;gap:4px;flex-wrap:wrap}
.handWrap{background:var(--surface);border-top:1px solid var(--line);padding:8px}
.hand{display:flex;gap:6px;height:100%;overflow-x:auto}
</style>
</head>
<body>
<div id="app">
  <div class="hud">
    <div class="title">THE GREY</div>
    <div class="chips">
      <span class="chip">‚ù§Ô∏è You <b id="hp">5</b></span>
      <span class="chip">ü§ñ AI <b id="aiHp">5</b></span>
      <span class="chip">‚ö° <b id="ae">0</b></span>
      <span class="chip">Deck <b id="deck">0</b></span>
      <span class="chip">Discard <b id="disc">0</b></span>
      <span class="chip">Glyphs <b id="glyphs">0</b></span>
      <span class="chip">Turn <b id="turnTag">1</b></span>
    </div>
    <div style="margin-left:auto">
      <select id="swSelect"></select>
      <button id="drawBtn">Draw</button>
      <button id="endBtn">End Turn</button>
      <button id="resetBtn">Reset</button>
    </div>
  </div>

  <div class="main">
    <div class="panel">
      <div class="boards">
        <div>
          <div class="sectionTitle">¬ª Your Board</div>
          <div id="slots" class="slots"></div>
          <div id="glyphView" class="glyphs"></div>
        </div>
        <div>
          <div class="sectionTitle">+ AI Board</div>
          <div id="aiSlots" class="slots"></div>
        </div>
      </div>
    </div>
    <div class="panel marketGrid">
      <div class="sectionTitle">‚â° Aetherflow</div>
      <div id="mCosts" class="costs"></div>
      <div id="mRow" class="cards"></div>
      <div class="sectionTitle">‚â° Log</div>
      <div id="log" class="log"></div>
    </div>
  </div>

  <div class="handWrap">
    <div class="sectionTitle">‚úã Your Hand</div>
    <div id="hand" class="hand"></div>
  </div>
</div>
<div id="error"></div>

<script>
// Minimal state so you see it working
let S={hp:5,ai:{hp:5},ae:0,deck:[{id:"c1",n:"Spark",t:"Instant",c:"black",v:1,txt:"Deal 1 dmg."}],hand:[],disc:[],slots:[null,null,null],glyphs:[],turn:1,flowRow:[]};
function render(){document.getElementById("hp").textContent=S.hp;document.getElementById("aiHp").textContent=S.ai.hp;document.getElementById("ae").textContent=S.ae;}
function reset(){S.hp=5;S.ai.hp=5;S.ae=0;render();}
document.getElementById("resetBtn").onclick=reset;
render();

// Error catcher
window.onerror=(msg,src,line,col,err)=>{const e=document.getElementById("error");e.style.display="block";e.textContent="JS Error: "+msg;};
</script>
</body>
</html>
