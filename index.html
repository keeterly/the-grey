<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Grey — Modular</title>

  <base href="./" />

  <link rel="stylesheet" href="./src/styles/theme.css">
  <link rel="stylesheet" href="./src/styles/layout.css">
  <link rel="stylesheet" href="./src/styles/components.css">
  <link rel="stylesheet" href="./src/styles/overrides.css">
  <meta name="theme-color" content="#EEE8DC" />
</head>

<body>
  <!-- HUD -->
  <div class="hudRow" id="hud">
    <div class="pill" id="pillYou">
      <div class="seg">♡ HP <span id="hud-you-hp">0</span></div>
      <div class="sep"></div>
      <div class="seg">⚡ Æ <span id="hud-you-ae">0</span></div>
    </div>
    <div class="pill" id="pillAi">
      <div class="seg">♡ AI HP <span id="hud-ai-hp">0</span></div>
      <div class="sep"></div>
      <div class="seg">⚡ AI Æ <span id="hud-ai-ae">0</span></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="topLog" class="topLog" aria-live="polite"></div>

  <!-- MAIN WRAP -->
  <div class="wrap">

    <!-- AI Board -->
    <div class="zone">
      <div class="title">AI Board</div>
      <div id="aiBoard" class="slots fixedRow"></div>
    </div>

    <!-- Aetherflow -->
    <div class="zone">
      <div class="title" style="text-align:center">Aetherflow</div>
      <div id="aetherflow" class="flowWrap slots fixedRow"></div>
    </div>

    <!-- Player Board -->
    <div class="zone">
      <div class="title">Your Board</div>
      <div id="yourBoard" class="slots fixedRow"></div>
    </div>
  </div>

  <!-- Glyph tray -->
  <div class="glyphTray" id="glyphTray"></div>

  <!-- LEFT: Deck & Discard -->
  <div class="leftDock">
    <button class="chipCirc" id="chipDeck" title="Deck">
      <svg viewBox="0 0 24 24" width="22" height="22">
        <rect x="6" y="5" width="12" height="16" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"/>
        <rect x="4" y="3" width="12" height="16" rx="2" fill="none" stroke="currentColor" stroke-width="1.2" opacity=".55"/>
      </svg>
      <small id="deckCount">0</small>
    </button>
    <button class="chipCirc" id="chipDiscard" title="Discard">
      <svg viewBox="0 0 24 24" width="22" height="22">
        <path d="M5 14h14v5a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-5Z" fill="none" stroke="currentColor" stroke-width="1.6"/>
        <path d="M12 4v9m0 0l-3-3m3 3l3-3" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <small id="discardCount">0</small>
    </button>
  </div>

  <!-- RIGHT: Aether gem -->
  <button class="aetherGem" id="aeGem" title="Aether">
    <span class="gemInner"><span id="aeGemCount">0</span></span>
  </button>

  <!-- Controls -->
  <div class="fabDial topRight">
    <button id="btnDraw"  class="fab" aria-label="Draw">⇧</button>
    <button id="btnEnd"   class="fab" aria-label="End Turn">⏵</button>
    <button id="btnReset" class="fab" aria-label="Reset">↺</button>
  </div>

  <!-- Hand ribbon -->
  <section class="ribbon-wrap"><div class="ribbon" id="ribbon"></div></section>

  <!-- Build stamp -->
  <script>
    (async () => {
      try {
        const r = await fetch('./stamp.json', { cache: 'no-store' });
        if (!r.ok) throw new Error('no stamp.json');
        const v = await r.json();
        console.log(`[THE GREY] branch=${v.branch} commit=${v.commit} builtAt=${v.builtAt}`);
      } catch (err) {
        console.log('[THE GREY] Unable to read stamp.json', err);
      }
    })();
  </script>

  <!-- Bridge bootstrap -->
  <script type="module">
    import { exposeToWindow } from "./bridge.js";
    exposeToWindow();
  </script>

  <script defer src="./assets/js/boot-debug.js"></script>
</body>
</html>
